# AIデスクトップマスコット「ここここ」
GeminiAPIとVOICEVOXを使用して、デスクトップマスコットがおしゃべりしてくれるソフトウェアです。
この度は、AIデスクトップマスコット「ここここ」をご利用いただきありがとうございます。
このアプリケーションは、Googleの最新AIとVOICEVOXを連携させた、対話型のデスクトップキャラクターです。

キャラクターとのおしゃべり、キャラクター同士の雑談、スケジュール通知など、様々な機能を楽しめます。

【※重要※】
このアプリケーションをご利用いただくには、いくつかの事前準備（Google APIキーの取得、VOICEVOXの導入など）が必須となります。
本手順書をよくお読みいただき、設定を進めてください。設定を色々試す前に、config.iniをコピーしてバックアップを取っておくことを強くお勧めします。

※本アプリケーションは、現在のバージョンではWindows専用です。

■ 1. 導入・設定手順
	アプリケーションを正しく動作させるために、以下のステップを順番に行ってください。

	【ステップ1】 VOICEVOXの準備
		キャラクターの音声を再生するために、VOICEVOXのインストールが必要です。

		VOICEVOXのインストール:
			VOICEVOXの公式サイトから、ソフトウェアをダウンロードし、PCにインストールしてください。
			公式サイト: https://voicevox.hiroshiba.jp/

		run.exeのパスを確認:
			インストール後、run.exe というファイルの場所を確認します。このファイルは、インストールしたVOICEVOXのフォルダ内にあります。
			通常、以下のいずれかの場所にあります。（(ユーザー名)の部分はご自身のPCのユーザー名に置き換えてください）
				C:\Users\(ユーザー名)\AppData\Local\VOICEVOX\vv-engine\run.exe
				C:\Users\(ユーザー名)\AppData\Local\Programs\VOICEVOX\run.exe
				※ AppDataは隠しフォルダです。エクスプローラーのアドレスバーに直接パスを貼り付けると簡単に見つけられます。

		config.iniにパスを設定:
			config.iniファイルを開き、[VOICEVOX]セクションにあるexe_pathに、先ほど確認したrun.exeのフルパスを貼り付けます。
			【重要！】 パスの区切り文字\は、\\のように2つ重ねてください。
			（設定例）
				[VOICEVOX]
				exe_path = C:\\Users\\TaroYamada\\AppData\\Local\\VOICEVOX\\vv-engine\\run.exe

		※このアプリケーションは、起動時に自動でVOICEVOXエンジン（run.exe）を立ち上げようと試みます。手動でVOICEVOXを起動しておく必要はありません。


	【ステップ2】 Google APIキーの準備
		キャラクターの会話を生成するために、GoogleのAPIキーが必要です。

		APIキーの取得:
			Google AI Studioにアクセスし、Googleアカウントでログインします。
			公式サイト: https://aistudio.google.com/

			ページ内の「Get API key」または「APIキーを取得」をクリックします。
			「Create API key in new project」（新しいプロジェクトでAPIキーを作成）をクリックします。
			キーが生成されたら、コピーボタンを押してクリップボードにコピーします。
			(このAPIキーはローカルの安全な場所に保存し、絶対に誰にも見せないでください。)

		config.iniにAPIキーを設定:
			config.iniファイルを開き、[GEMINI]と[GEMMA]セクションにあるGEMINI_API_KEYとGEMMA_API_KEYの両方に、先ほどコピーしたAPIキーを貼り付けます。
			現在、会話生成（Gemini）と感情分析（Gemma）は同じキーで動作します。
			（設定例）
				[GEMINI]
					GEMINI_API_KEY = AxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxU
				[GEMMA]
					GEMMA_API_KEY = AxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxU


	【ステップ3】 AIモデル名の確認（任意）
		config.iniにはAIモデル名がプリセットされていますが、Googleの更新により変更される可能性があります。
		もしアプリが動作しない場合、Google AI Studioの「利用可能なモデルの一覧」や公式ドキュメントなどから最新のモデル名を確認し、config.iniの[GEMINI]セクションにある各MODEL_NAMEの項目を書き換えてください。
		本アプリでは、思考モード（Pro系）、通常会話（Flash系）、タッチ反応（旧モデル系）など、用途に応じてモデルを使い分けています。

	【ステップ4】 アプリケーションの起動
		すべての設定が完了したら、フォルダ内にあるAIDesktopMascot.exe（またはそれに類する実行ファイル）をダブルクリックして起動してください。
		初回起動時は、裏側でVOICEVOXエンジンが立ち上がるため、キャラクターが話し始めるまでに少し時間がかかる場合があります。


■ 2. 【最重要】API利用量とコストに関する注意
	このアプリケーションは、より人間らしい対話を実現するために、バックグラウンドでも定期的にAIとの通信を行います（自動での話しかけ、スケジュール通知など）。
	そのため、24時間連続で稼働させた場合、Google AIの無料枠（Free Tier）の1日あたりのリクエスト上限のかなりの部分を消費する可能性があります。
	つきましては、以下の点をご理解の上、ご利用ください。

	・他の用途でAPIキーを使っていない方:
		このアプリ単体であれば、多くの場合、config.iniで設定された各モデルの無料枠、日間上限回数（RPD）の範囲内で十分に楽しむことができます。

	・他のアプリや開発で既に同じAPIキーを利用している方:
		意図せず無料枠を使い切り、他のアプリが動作しなくなったり、予期せぬ課金が発生したりするリスクがあります。
		以下のいずれかの対策を強く推奨します。
		・【推奨】このアプリ専用のAPIキーを取得する:
			Google AI Studioで「Create API key in new project」を選択し、このアプリ専用のプロジェクトとAPIキーを作成してください。
			これにより、他のアプリの利用量と完全に分離できます。
		・Google Cloudで有料プランにアップグレードする:
			利用量が多い場合は、請求先アカウントを有効化し、有料プランへ移行することもご検討ください。


■ 3. 基本的な使い方
	設定が完了したら、早速キャラクターと触れ合ってみましょう。

	・キャラクターとの対話
		キャラクターの下部にあるテキストボックスに話したいことを入力し、「送信」ボタンかEnterキーを押すと、キャラクターが応答してくれます。
		入力欄でキーボードの↑ ↓キーを押すと、過去の入力履歴を呼び出して再利用できます。

	・キャラクターの移動・配置
		キャラクターの画像部分をドラッグ＆ドロップすることで、デスクトップ上の好きな場所に移動できます。キャラクターを画面の左右どちらかに寄せると、自動的に内側を向くようにレイアウトが調整されます。この位置情報はアプリ終了時にposition.iniに保存され、次回起動時に再現されます。

	・右クリックメニュー
		キャラクターを右クリックすると、様々な設定ができるメニューが表示されます。
			・表示/非表示: キャラクターウィンドウの表示/非表示を切り替えます。
			・常に手前に表示: チェックを入れると、他のウィンドウより常に手前に表示されます。
			・カラーテーマ: アプリケーションのUI配色を変更できます。
			・最前列に移動: ウィンドウが他のアプリに隠れた時に、一時的に最前面に表示します。
			・自動発話を有効にする: キャラクターが自動で話しかけてくる機能のON/OFFを切り替えます。
			・自動発話の間隔: キャラクターが話しかけてくる頻度を調整できます。「短い」設定はAPI消費が増えるためご注意ください。
			・スケジュール通知を有効にする: スケジュール機能のON/OFFを切り替えます。
			・スケジュール管理...: スケジュールを追加・編集する画面を開きます。
			・音声再生: チェックを外すと音声が出なくなります（ミュート）。
			・API残回数: その日のAPI残り使用可能回数の目安を確認できます。
			・API接続設定...: APIキーやVOICEVOXのパスなどをGUIで設定できます。
			・思考モード (Pro使用): チェックを入れると、より高性能なAIモデルを使って応答するようになり、賢い回答が期待できますが、API消費も増えます。
			・スクリーンショット添付モード: 現在見ている画面をAIに認識させて、それについて話すことができます。（詳細は後述）
			・衣装変更: キャラクターの衣装を変更できます。
			・位置調整: キャラクターを画面の左端/右端に寄せたり、手動で左右反転させたりできます。
			・お休みさせる: (2人モード時のみ) キャラクターを退場させ、1人モードに移行します。
			・キャラクター変更/追加: 別のキャラクターと交代したり、新しくキャラクターを追加して2人モードにしたりできます。
			・会話ログをクリア: そのキャラクターのこれまでの会話履歴をリセットします。
			・終了: アプリケーションを終了します。

	・タッチ操作
		キャラクターの画像の上にマウスカーソルを乗せると、カーソルの形が変わる場所があります。
		その場所をクリックすると、キャラクターが特別な反応を返してくれます。
		複数の反応エリアが重なっている場所では、マウスホイールを回すことでアクションを選択できます。

	・好感度システム
		ユーザーとのやり取りに応じて、キャラクターの好感度が-500〜500の範囲で変動します。好感度はAIの応答や、キャラクターの横に表示されるハートマークに影響を与えます。このデータはキャラクターのフォルダ内にsavedata.iniとして自動で保存されます。

	・スケジュール機能
		右クリックメニューの「スケジュール管理」から、キャラクターに通知してほしい予定を追加・編集できます。「毎年」「毎月」「毎日」のような繰り返し設定や、「終日イベント」も登録可能です。旧来の時報機能は、このスケジュール機能に統合されました。

	・スクリーンショット機能の活用
		キャラクターにPCの画面を見せて、それについてコメントさせることができます。
		右クリックし、「スクリーンショット添付モード」にチェックを入れます。
		「キャプチャ対象選択」から、キャラクターに見せたいウィンドウやディスプレイを選択します。
		この状態でキャラクターに話しかけると、AIがスクリーンショットの内容を認識し、応答に含めてくれます。
		（例：ブラウザで猫の画像を見せながら「この子、可愛くない？」と話しかけるなど）

■ 4. 応用編：キャラクターのカスタマイズ
	config.iniやキャラクターフォルダ内のcharacter.iniを編集することで、キャラクターの様々な要素をカスタマイズできます。

	・性格を変える:
		characters/(キャラ名)/character.ini の CHARACTER_PERSONALITY の文章を書き換えることで、AIの口調や性格を自由に変更できます。
		「あなたは〇〇です。△△な口調で話してください。」のように具体的に指示するのがコツです。

	・音声を変える:
		characters/(キャラ名)/character.ini の DEFAULT_SPEAKER_ID の数値を、VOICEVOXエディタで確認できる話者IDに変更すると、別のキャラクターの音声で喋るようになります。

	・エラーメッセージを変える:
		characters/(キャラ名)/character.ini に [SYSTEM_MESSAGES] セクションを追加し、
		APIエラー時などのセリフをキャラクターに合わせて変更できます。詳細はcharacter.ini内のコメントを参照してください。

	・好感度表示を変える:
		characters/(キャラ名)/character.ini の [FAVORABILITY_STAGES] で関係性の名前を、
		[FAVORABILITY_HEARTS] で表示するハート画像を変更できます。

	・UIカラーテーマの作成:
		colorthemes フォルダに自作の.iniファイルを追加することで、オリジナルのUI配色を作成できます。
		既存のファイルを参考にしてください。

	・オリジナルキャラクターの作成:
		・画像: キャラクター用のフォルダを作成し、
			その中に衣装名のフォルダ（例: default）を作って立ち絵画像を配置します。
			最低限normal.pngがあれば動作しますが、口パクさせたい場合はnormal_open.pngとnormal_close.pngを、
			感情差分を追加したい場合はjoy.png, joy_open.png, joy_close.pngなどを追加で配置します。
		・衣装: character.iniの[COSTUMES]セクションで衣装を定義し、
			[COSTUME_DETAIL_衣装ID]セクションで詳細（画像パス、利用可能な感情など）を設定します。
		・タッチエリア: character.iniの各衣装詳細セクションで、タッチ判定エリアを設定できます。
			元画像の座標 [x1, y1, x2, y2]、AIに伝わるアクション名、表示されるカーソル名を指定します。
			複数の矩形を1つのアクションに割り当てることも可能です。
				例: 複数の矩形を「頭を撫でる」に割り当て
				touch_area_1 = [[100, 50, 200, 150], [210, 60, 250, 140]], 頭を撫でる, hand


■ 5. トラブルシューティング
	Q. 起動しない、または起動直後に終了する。
	A. config.iniのexe_pathやGEMINI_API_KEY/GEMMA_API_KEYの設定が正しいか、もう一度ご確認ください。
		特にexe_pathの\が\\と2つ重ねになっているか確認してください。

	Q. キャラクターが喋らない、反応がない。
	A1. APIキーが間違っているか、Googleの無料枠を使い切っている可能性があります。
		→ 右クリックメニューの「API残回数」で、その日の残り使用可能回数を確認できます。これが0に近い場合、翌日まで待つか、有料プランに移行する必要があります。
		A2. VOICEVOXが正常に起動していない可能性があります。
		→ タスクマネージャーでrun.exeが実行中か確認してください。一度手動でVOICEVOXを起動し、音声が再生できるか確認するのも有効です。
		A3. config.iniに設定したAIモデル名が古い可能性があります。ステップ3を参考に、最新のモデル名を確認・更新してください。

	Q. キャラクターが「考え中...」のまま動かなくなった。
	A. ネットワークの問題やAPIサーバーの遅延が原因かもしれません。
		基本的には一定時間（標準で30秒）でタイムアウトしてエラーメッセージが表示されますが、
		それでも反応がない場合は、アプリケーションを一度終了し、手動で再起動してください。

	Q. 画像のフチがきれいに透過できない。
	A. config.iniの[UI]セクションにあるTRANSPARENCY_TOLERANCEの値を少しずつ変えてみてください。
		例: 50 -> 60
		また、キャラクター個別のcharacter.iniの[INFO]セクションにTRANSPARENT_COLORやEDGE_COLORを記述することで、キャラごとに色を指定できます。

	Q. 4Kモニターなどでキャラクターが小さく/大きく表示される。
	A. config.iniの[UI]セクションにあるWINDOW_WIDTH_RATIOの値を変更して調整してください。
		例: 0.2 -> 0.15
		この値は画面全体の幅に対する比率です。